Automatic Diferentiation of Algorithms: Theory, Implementation, and Application